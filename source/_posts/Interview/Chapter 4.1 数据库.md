---
title: Chapter 4.1 数据库

categories:
- Interview

date: 2020-04-28 00:00:41
---
## 最全 MySQL 面试 60 题和答案
#### MySQL 中有哪几种锁？
MySQL 的锁大致分为 3 种：表锁、页锁、行锁。

他们的区别如下

|锁名称|锁定粒度|开销|并发量|冲突概率|支持引擎|
| :-- |
|表锁|整张表|小|低|大|MyISAM、InnoDB|
|页锁|邻的一组记录|中|中|中|BDB|
|行锁|指定的记录|大|高|小|InnoDB|

#### MySQL 中有哪些不同的表格（存储引擎）？
数据库存储引擎是数据库底层软件组件，数据库管理系统使用数据引擎进行创建、查询、更新和删除数据操作。不同的存储引擎提供不同的存储机制、索引技巧、锁定水平等功能，使用不同的存储引擎还可以获得特定的功能。

引擎区别：

|存储引擎|文件结构|性能|锁支持|ACID 兼容|隔离级别|适用场景|
| :-- |
|MyISAM||较高的插入、查询速度|仅支持表锁|不支持||
|InnoDB|支持事务，默认引擎|较慢的性能|支持表锁和行锁|支持|支持事务的四种隔离级别|
|MEMORY|将表中的数据存储到内存中|极快的插入、查询速度||不支持||临时表，存放查询的中间结果|
|Archive||||||存储归档数据，如记录日志信息|

性能对比：
（待补充）

#### 简述在 MySQL 数据库中 MyISAM 和 InnoDB 的区别
同上

#### MySQL 中 InnoDB 支持的四种事务隔离级别名称，以及逐级之间的区别？

|隔离界别|描述|脏读|不可重复读|幻读|
| :-- |
|Read uncommited|读未提交|不可避免|不可避免|不可避免|
|Read committed|读已提交|可避免|不可避免|不可避免|
|Repeatable read|可重复读|可避免|可避免|不可避免|
|Serializable|串行化|可避免|可避免|可避免|

#### CHAR 和 VARCHAR 的区别？

#### 主键和候选键有什么区别？

#### myisamchk 是用来做什么的？

#### MyISAM Static 和 MyISAM Dynamic 有什么区别？

#### 如果一个表有一列定义为TIMESTAMP，将发生什么？

#### 列设置为 AUTO INCREMENT 时，如果在表中达到最大值，会发生什么情况？
它会停止递增，任何进一步的插入都将产生错误，因为密钥已被使用。（没法复现，不知多少才是最大值）

#### 怎样才能找出最后一次插入时分配了哪个自动增量？
`LAST_INSERT_ID` 函数将返回由 `AUTO_INCREMENT` 分配的最后一个值，并且不需要指定表名称。

```sql
-- 插入数据，没有指定Id
INSERT INTO user(id, name) VALUES(NULL, 'zhangsan');

-- 查询指定的新增的Id（当前客户端的）
select LAST_INSERT_ID();
-- 10
```

#### 你怎么看到为表格定义的所有索引？
使用 `SHOW INDEX` 命令可以查看此表所定义的索引。

```sql
SHOW INDEX FROM table_name;
```

#### like 声明中的 ％ 和 _ 是什么意思？
1. `%` 表示任意 0 个或多个字符。可匹配任意类型和长度的字符，有些情况下若是中文，请使用两个百分号表示。
1. `_` 表示任意单个字符。匹配单个任意字符，它常用来限制表达式的字符长度语句。
1. `\` 表示转义字符。
1. `[]` ?? 表示括号内所列字符中的一个（类似正则表达式）。指定一个字符、字符串或范围，要求所匹配对象为它们中的任一个。
1. `[^]` ?? 表示不在括号所列之内的单个字符。其取值和 [] 相同，但它要求所匹配对象为指定字符以外的任一个字符。

示例：
1. `%a` 以 a 结尾的数据
1. `a%` 以 a 开头的数据
1. `%a%` 含有 a 的数据
1. `%a\_`  以 a_ 结尾的数据
1. `_a` 两位且结尾字母是 a 的
1. `a_` 两位且开头字母是 a 的
1. `_a_` 三位且中间字母是 a 的

#### 如何在 Unix 和 MySQL 时间戳之间进行转换？
1. Unix 时间精确到秒，从协调世界时 1970 年 1 月 1 日 0 时 0 分 0 秒起至现在的总秒数。
1. MySQL `FROM_UNIXTIME` 函数将 Unix 时间戳转为 MySQL 日期。
1. MySQL `UNIX_TIMESTAMP` 函数将 MySQL 日期转换为 Unix 时间戳。

```sql
-- 获取 MySQL 当前时间
SELECT NOW();
-- 2020-06-02 17:11:09

-- 获取 Unix 时间戳
SELECT UNIX_TIMESTAMP(); 
-- 1591089100

-- Unix 时间戳转换成为 MySQL 时间
SELECT FROM_UNIXTIME(1156219870); 
-- 2006-08-22 12:11:10

-- MySQL 日期转换成为 Unix 时间戳
SELECT UNIX_TIMESTAMP(NOW()); 
-- 1591089100
```

#### 列对比运算符是什么？
比较运算符可以判断表中的哪些记录是符合条件的。比较结果为真，则返回 1，为假则返回 0，比较结果不确定则返回 NULL。

在 `SELECT` 语句的列比较中使用 `=`，`<>`，`<`，`<=`，`>`，`>=`，`<<`，`>>`，`<=>`，`AND`，`IS NULL`, `IS NOT NULL`, `OR` 或 `LIKE `运算符。

#### BLOB 和 TEXT 有什么区别？
1. BLOB 是一个二进制对象，可以容纳可变数量的数据。TEXT 是一个不区分大小写的 BLOB。
1. BLOB 和 TEXT 类型之间的唯一区别在于对 BLOB 值进行排序和比较时区分大小写，对 TEXT 值不区分大小写。

#### mysql_fetch_array 和 mysql_fetch_object 的区别是什么？
PHP 不记。

1. mysql_fetch_array – 将结果行作为关联数组或来自数据库的常规数组返回。
1. mysql_fetch_object – 从数据库返回结果行作为对象。

#### MyISAM 表格将在哪里存储，并且还提供其存储格式？
在没有指定的情况下，MySQL 数据存储在 `./data` 目录下。

每个 MyISAM 表格以三种格式存储在磁盘上：
1. `.frm` 文件存储表定义
1. `.MYD` 文件存储表数据
1. `.MYI` 文件存储表索引

#### MySQL 如何优化 DISTINCT？
`DISTINCT` 在所有列上转换为 `GROUP BY`，并与 `ORDER BY` 子句结合使用。

```sql
SELECT DISTINCT t1.a FROM t1, t2 WHERE t1.a = t2.a;
```

#### 如何显示前 50 行？
```sql
SELECT * FROM table_name LIMIT 0, 50;
```

#### 可以使用多少列创建索引？
任何标准表最多可以创建 16 个索引列。

#### NOW() 和 CURRENT_DATE() 有什么区别？
1. `NOW()` 命令用于显示当前年份，月份，日期，小时，分钟和秒。
1. `CURRENT_DATE()` 仅显示当前年份，月份和日期。

#### 什么是非标准字符串类型？
1. TINYTEXT
1. TEXT
1. MEDIUMTEXT
1. LONGTEXT

#### 什么是通用 SQL 函数？
1. CONCAT(A, B) – 连接两个字符串值以创建单个字符串输出。通常用于将两个或多个字段合并为一个字段。
1. FORMAT(X, D)- 格式化数字X到D有效数字。
1. CURRDATE(), CURRTIME()- 返回当前日期或时间。
1. NOW（） – 将当前日期和时间作为一个值返回。
1. MONTH（），DAY（），YEAR（），WEEK（），WEEKDAY（） – 从日期值中提取给定数据。
1. HOUR（），MINUTE（），SECOND（） – 从时间值中提取给定数据。
1. DATEDIFF（A，B） – 确定两个日期之间的差异，通常用于计算年龄
1. SUBTIMES（A，B） – 确定两次之间的差异。
1. FROMDAYS（INT） – 将整数天数转换为日期值。

#### MySQL 支持事务吗？
1. MySQL 默认的 InnoDB 存储引擎是支持事务的，其它存储引擎不支持
1. 缺省模式下，MySQL 是 autocommit 模式的，所有的数据库更新操作都会即时提交。
1. 可以设置 `SET AUTOCOMMIT = 0` 关闭 autocommit 模式，在这种情况下，你必须使用 COMMIT 来提交你的更改，或者用 ROLLBACK 来回滚你的更改。

#### MySQL 里记录货币用什么字段类型好
NUMERIC 和 DECIMAL 类型被 MySQL 实现为同样的类型，这在 SQL92 标准允许。他们被用于保存值，该值的准确精度是极其重要的值，例如与金钱有关的数据。当声明一个类是这些类型之一时，精度和规模的能被(并且通常是)指定。

例如：
```sql
salary DECIMAL(9,2)
```

在这个例子中，9 代表将被用于存储值的总的小数位数，而 2 代表将被用于存储小数点后的位数。

因此，在这种情况下，能被存储在salary列中的值的范围是从 -9999999.99 到 9999999.99。

#### MySQL 有关权限的表都有哪几个？
MySQL 服务器通过权限表来控制用户对数据库的访问，权限表存放在 MySQL 数据库里，由 mysql_install_db 脚本初始化。这些权限表分别 user，db，table_priv，columns_priv 和 host。

#### 列的字符串类型可以是什么？

字符串类型是：
1. SET
1. ENUM
1. CHAR
1. VARCHAR
1. BLOB
1. TEXT

???

#### MySQL 数据库作发布系统的存储，一天五万条以上的增量，预计运维三年,怎么优化？
1. 选择合适的表字段数据类型和存储引擎，适当的添加索引。
1. MySQL 库主从读写分离。
1. 找规律分表，减少单表中的数据量提高查询速度。
1. 添加缓存机制，比如 memcached，apc 等。
1. 不经常改动的页面，生成静态页面。
1. 书写高效率的SQL。比如 SELECT * FROM TABEL 改为 SELECT field_1, field_2, field_3 FROM TABLE.

???

## 108道Java面试题:工作10年，面试超过500人想进阿里总结出的!

#### 数据库三范式及判断、E-R 图

#### InnoDB 和 MyISAM 存储引擎的区别

#### 索引分类，最左前缀原则，哪些条件无法使用索引

#### B 树、B+ 树区别，索引为何使用 B+ 树

#### 聚集索引与非聚集索引（使用非聚集索引的查询过程）

#### 事务的ACID（原子性、一致性、隔离性、持久性）

#### 事务隔离级别和各自存在的问题（脏读、不可重复读、幻读）和解决方式（间隙锁及MVCC）

#### 乐观锁和悲观锁、行锁与表锁、共享锁与排他锁

#### MVCC（增加两个版本号）及delete、update、select时的具体控制

#### 死锁判定原理和具体场景

#### 查询缓慢和解决方式（explain、慢查询日志、show profile等）

#### drop、truncate、delete 区别

#### 查询语句不同元素（where、jion、limit、group by、having等等）执行先后顺序

#### mysql优化，读写分离、主从复制

#### 数据库崩溃时事务的恢复机制（REDO 日志和 UNDO 日志）

## 2019 最全支付宝高级Java现场面试37题
#### SQL优化，常用的索引？

#### 数据库性能调优如何做

#### 数据库事务属性

## 2019 最全阿里天猫Java 3面真题，含面试题答案！
无

## 2019 最新阿里中间件Java 4轮面试题！60万年薪起步~
#### 数据库索引，表锁；乐观锁；悲观锁

## 2019蚂蚁金服 Java面试题目！涵盖现场3面真题
#### 如何做的 MySQL 优化

## 阿里蚂蚁金服中间件(Java 4轮面试题含答案)：Redis缓存+线程锁+微服务等
#### MySQL 事务隔离级别以及 MVCC 机制