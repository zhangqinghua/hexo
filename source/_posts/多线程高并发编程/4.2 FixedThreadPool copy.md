---
title: 4.2 FixedThreadPool

categories:
- 多线程高并发编程

tags:
- Thread
- FixedThreadPool

date: 2020-01-23 15:00
---
FixedThreadPool适用于任务量比较固定但耗时长的任务。它采用了无界的阻塞队列`LinkedBlockingQueue`，在执行`execute`方法时，如果运行的线程数没有达到`corePoolSize`就创建线程执行任务，否则就阻塞在任务队列中，直到有空闲线程来取。

## 构造函数
```java
new ThreadPoolExecutor(nThreads, nThreads, 
                       0L, TimeUnit.MILLISECONDS, 
                       new LinkedBlockingQueue<Runnable>());
```

## 创建方式
```java
// nThreads为线程的数量
Executors.newFixedThreadPool(int nThreads);
// nThreads为线程的数量，threadFactory创建线程
Executors.newFixedThreadPool(int nThreads, ThreadFactory threadFactory);
```
## 特点
1. 线程池中的线程处于一定的量，可以很好的控制线程并发量。
1. 线程可以重复被使用，在显式的关闭之前都将一直存在
1. 超出数量的任务需要在队列中等待
1. 全是核心线程

## 实例
```java
public class FixedThreadPoolCase {

    public static void main(String[] args) throws InterruptedException {
        ExecutorService exec = Executors.newFixedThreadPool(3);

        // 无论 sleep 间隔时间是多少，总共都创建 3 个线程，并交替执行。
        for (int i = 0; i < 5; i++) {
            exec.execute(new LiftOff());
            Thread.sleep(10);
        }
        exec.shutdown();
    }
}
```