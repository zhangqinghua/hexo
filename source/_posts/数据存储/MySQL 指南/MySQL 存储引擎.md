---
title: MySQL 存储引擎

categories:
- 数据存储
- MySQL 指南

date: 2020-04-28 00:00:43
---
## 什么是存储引擎？
存储引擎其实就是如何存储数据、如何为存储的数据建立索引和如何更新、查询数据等约束的实现方法。因为在关系数据库中数据是以表的形式存储的，所以存储引擎也可以称为表类型（即存储和操作此表的类型）。

存储引擎的作用规定了数据存储时的存储结构。在现实生活中，由于不同的业务产生了不同的数据，这些数据有的可能偏重于频繁查询，有的要求增删速度快，有的则对事务、索引、外键有特俗的规定。这样一来就对存储数据的表要求不同的数据组织结构，也就是存储引擎。

在 Oracle 和 SQL Server 等数据库只有一种存储引擎，所有的数据存储管理机制都是一样的；而 MySQL 数据库提供了多种存储引擎，用户可以根据不同的需求为数据表选择不同的存储引擎，也可以根据需要编写自己的存储引擎。

## 常用命令
#### 查询默认的存储引擎
```sql
> show variables like '%storage_engine%';
+----------------------------+--------+
| Variable_name              | Value  |
+----------------------------+--------+
| default_storage_engine     | InnoDB |
+----------------------------+--------+
| default_tmp_storage_engine | InnoDB |
+----------------------------+--------+

2 row in set (0.00 sec)	
```

#### 查询支持的全部存储引擎
```sql
> show engines;
+--------+---------+------------------------------------------+--------------+------+------------+
| Engine | Support | Comment                                  | Transactions | XA   | Savepoints |
+--------+---------+------------------------------------------+--------------+------+------------+
| MyISAM | YES     | MyISAM storage engine                    | NO           | NO   | NO         |
+--------+---------+------------------------------------------+--------------+------+------------+
| InnoDB | DEFAULT | Supports transactions, row-level locking | YES          | YES  | YES        |
+--------+---------+------------------------------------------+--------------+------+------------+

2 row in set (0.00 sec)			
```

## 类型选择

创建表时，使用字符串类型应该遵循以下原则：
1. 从速度方面考虑，要选择固定的列，可以使用 **CHAR** 类型。
1. 要节省空间，使用动态的列，可以使用 **VARCHAR** 类型。
1. 要将列中的内容限制在一种选择，可以使用 **ENUM** 类型。
1. 允许在一个列中有多于一个的条目，可以使用 **SET** 类型。
1. 如果搜索的内容不区分大小写，可以使用 **TEXT** 类型。
1. 如果要搜索的内容区分大小写，可以使用 **BLOB** 类型。

## 存储引擎对比
|引擎名称|优点|缺点|应用场景|
| :-- | :-- | :-- | :-- |
|MyISAM|访问速度快，对事务完整性没有要求，以 select、insert 为主的应用基本上可以使用这个引擎。|不支持事务/行级锁/外建约束|适合管理邮件或 Web 服务器日志数据|
|InnoDB|事务型存储引擎，支持事务/行级锁/外建约束，支持制动灾难恢复|处理效率会比 MyISAM 差一些，并且会占用更多的磁盘空间以保留数据和索引|需要事务支持，并且有较高的并发读取频率|
|MEMORY|为得到更快的响应速度，采用的逻辑存储介质是系统内存|当 MySQL 守护进程崩溃时，所有的 Memory 数据都会丢失；不能使用 BLOB 或 TEXT 这样子的长度可变的数据类型|临时表|
|MERGE|是 MyISAM 的一种变种。合并表是将几个相同的 MyISAM 表合并为一个虚表||常用于日志和数据仓库|
|ARCHIVE|归档的意思，支持索引，拥有很好的压缩机制|仅支持插入和查询功能|经常被用来当作仓库使用|