---
title: Chapter 5.1 索引的简介

categories:
- MySQL 性能调优

date: 2020-04-28 00:00:51

mathjax: true
---
索引是用来快速检索出具有特定值的记录。MySQL 官方对索引的定义为：索引（Index）是帮助 MySQL 高效获取数据的数据结构。

## 索引的作用

## 索引的特征
索引有两个特征，即唯一性索引和复合索引。

## 索引的类型
MySQL 目前主要有以下几种索引类型：

1. 普通索引
    最基本的索引，它没有任何限制。普通索引的唯一任务是加快对数据的访问速度。

1. 唯一索引
    它与前面的普通索引类似，不同的就是：索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一。
    
    事实上，在许多场合，人们创建唯一索引的目的往往不是为了提高访问速度，而只是为了避免数据出现重复。

1. 主键索引
    是一种特殊的唯一索引，一个表只能有一个主键，不允许有空值。一般是在建表的时候同时创建主键索引。主键索引与唯一索引的唯一区别是：前者在定义时使用的关键字是 PRIMARY 而不是 UNIQUE。 

1. 外键索引 
    如果为某个外键字段定义了一个外键约束条件，MySQL就会定义一个内部索引来帮助自己以最有效率的方式去管理和使用外键约束条件。 

1. 组合索引
    指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。使用组合索引时遵循最左前缀原则。

1. 全文索引
    通过数值比较、范围过滤等就可以完成绝大多数我们需要的查询，但是，如果希望通过关键字的匹配来进行查询过滤，那么就需要基于相似度的查询，而不是原来的精确数值比较。全文索引就是为这种场景设计的。

    你可能会说，用 like + % 就可以实现模糊匹配了，为什么还要全文索引？like + % 在文本比较少时是合适的，但是对于大量的文本数据检索，是不可想象的。全文索引在大量的数据面前，能比 like + % 快 N 倍，速度不是一个数量级，但是全文索引可能存在精度问题。

    你可能没有注意过全文索引，不过至少应该对一种全文索引技术比较熟悉：各种的搜索引擎。虽然搜索引擎的索引对象是超大量的数据，并且通常其背后都不是关系型数据库，不过全文索引的基本原理是一样的。



## 采用查找算法
#### Hash 散列法 
哈希算法（也称散列），就是把任意长度值（key）通过散列算法变换成固定长度的 key 地址，通过这个地址进行访问的数据结构。它通过把关键码值映射到表中一个位置来访问记录，以加快查找的速度。这个映射函数叫做散列函数，存放记录的数组叫做散列表。

哈希的时间复杂度是 $O(1)$。

哈希的不足是：1 不支持范围查询，2 不支持排序。

![](http://5b0988e595225.cdn.sohucs.com/images/20190108/90b457d976614a65826199b1f41f3d28.gif)

#### 二叉树
真实的数据存于叶子节点；非叶子节点存储指引搜索方向的数据项。

二叉树支持范围查询。

不足的地方是，根据我们插入的顺序，极端不平衡。

![](http://www.cxyxiaowu.com/wp-content/uploads/2019/10/1571058094-fa3f978179e2c46.jpeg)

#### 红黑树
红黑树是平衡二叉树的一种，解决了插入顺序不平衡的问题。但是也只是相对的减少不平衡，还是会往右边倾斜。

![](https://img.jbzj.com/file_images/article/201901/2019110153603213.gif?2019010153616)

#### BTree
真实的数据存于叶子节点；非叶子节点存储指引搜索方向的数据项。

![](https://imgconvert.csdnimg.cn/aHR0cDovL2ltZy5tcC5zb2h1LmNvbS91cGxvYWQvMjAxNzA3MTMvM2JkMmI0MjIwYTBmNGQxODg3ZTI5NDNhNzI5YzQwYTFfdGgucG5n?x-oss-process=image/format,png)

> B-树、B树和B-tree是同一个数据结构，只不过英语翻译过来之后，有些人误解了以为是多种树。所以好多讲解树的数据结构的博客完全是误导初学者。。。请读者认真分辨。

## 算法对比
|算法名称|时间复杂度|支持范围查询|备注|
| :-- | :-- | :-- | :-- |
|暴力遍历|$O(n^2)$|不支持||
|哈希|$O(1)$|不支持||
|二叉树|$O(n)$|支持|不平衡，时间复杂度就是树的深度|
|红黑树||支持|不平衡|
|B-Tree||支持||
|B+Tree||支持||


