---
title: Chapter 1.1 分布式锁

categories:
- 后端开发
- 分布式

date: 2020-05-18 00:00:11
---

## 什么是锁
在多线程的环境下，为了保证一个代码块在同一时间只能由一个线程访问，我们需要对此代码块加锁。在 Java 中我们一般可以使用 **synchronized** 和 **ReetrantLock** 实现。

## 什么是分布式锁
对于分布式场景，我们可以使用分布式锁，它是控制分布式系统之间互斥访问共享资源的一种方式。

比如说在一个分布式系统中，多台机器上部署了多个服务，当客户端一个用户发起一个数据插入请求时，如果没有分布式锁机制保证，那么那多台机器上的多个服务可能进行并发插入操作，导致数据重复插入，对于某些不允许有多余数据的业务来说，这就会造成问题。而分布式锁机制就是为了解决类似这类问题，保证多个服务之间互斥的访问共享资源，如果一个服务抢占了分布式锁，其他服务没获取到锁，就不进行后续操作。大致意思如下图所示：
![](https://user-gold-cdn.xitu.io/2019/4/25/16a53749547937bb?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)


## 分布式锁的实现方式

## 基于数据库实现
基于 MySql 的 InnoDB 引擎，可以使用以下方法来实现加锁操作：
```sql

```

## 基于 Redis 实现

## 基于 ZooKeeper 实现